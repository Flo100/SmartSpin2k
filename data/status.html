<!DOCTYPE html>
<html>

<head>
  <title>SmartBike2K Web Server</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>


<body style="background-color:#3498db;">
  <h1 style="text-align: center;"><strong>Status</strong></h1>
  <h2>
    <p style="text-align: left;"></p>
    <form action="requestConfigValues()">
      <table border="0" style="height: 30px; width: 36.0582%; border-collapse: collapse; border-style: none;"
        height="182" cellspacing="1">
        <tbody>
          <tr style="height: 20px;">
            <td style="width: 14%; height: 20px;">
              <p><label for="ssid">SSID</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="ssid" name="ssid" value="loading" /></td>
                        <td style="width: 14%; height: 20px;">
              <p><label for="ssid">simulatedWatts</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="simulatedWatts" name="simulatedWatts" value="loading" /></td>
          </tr>
          <tr style="height: 20px;">
            <td style="width: 14%; height: 20px;">
              <p><label for="password">Password</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="password" name="password" value="loading" />
            </td>
                        <td style="width: 14%; height: 20px;">
              <p><label for="ssid">simulatedHr</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="simulatedHr" name="simulatedHr" value="loading" /></td>
          </tr>
          <tr style="height: 20px;">
            <td style="width: 14%; height: 20px;">
              <p><label for="inclineStep">Incline Step</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="inclineStep" name="inclineStep"
                value="loading" /></td>
                            <td style="width: 14%; height: 20px;">
              <p><label for="ssid">simulatedCad</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="simulatedCad" name="simulatedCad" value="loading" /></td>
          </tr>
          <tr style="height: 20px;">
            <td style="width: 14%; height: 20px;">
              <p><label for="shiftStep">Shift Step</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="shiftStep" name="shiftStep" value="loading" />
            </td>
                        <td style="width: 14%; height: 20px;">
              <p><label for="ssid">incline</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="incline" name="incline" value="loading" /></td>
          </tr>
          <tr style="height: 20px;">
            <td style="width: 14%; height: 20px;">
              <p><label for="inclineMultiplier">Incline Multiplier</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="inclineMultiplier" name="inclineMultiplier"
                value="loading" /></td>
                            <td style="width: 14%; height: 20px;">
              <p><label for="ssid">connectedPowerMeter</label></p>
            </td>
            <td style="width: 14%; height: 20px;"><input type="text" id="connectedPowerMeter" name="ConnectedPowerMeter" value="loading" /></td>
          </tr>

          
        </tbody>
      </table>
      <p style="text-align: center;"><input type="submit" value="Refresh!" /></p>
    </form>
   <br>
    
    <div id="debug" name="debug"style="height:400px;width:700px;border:1px solid #ccc;font:16px/26px Georgia, Garamond, Serif;overflow:auto;"> loading </div>
<br>

  </h2>
</body>

<script>


  //Update values on specified interval loading late because this tiny webserver hates frequent requests
   setInterval(function () {
    if (document.getElementById("ssid").value == "loading"){
    requestConfigValues();
    }

  }, 1000);

  function requestConfigValues() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function () {
      if (this.readyState == 4 && this.status == 200) {
        var obj = JSON.parse(this.responseText);
        document.getElementById("ssid").value = obj.ssid;
        document.getElementById("password").value = obj.password;
        document.getElementById("inclineStep").value = obj.inclineStep;
        document.getElementById("shiftStep").value = obj.shiftStep;
        document.getElementById("inclineMultiplier").value = obj.inclineMultiplier;
        document.getElementById("incline").value = obj.incline;
        document.getElementById("simulatedHr").value = obj.simulatedHr;
        document.getElementById("simulatedWatts").value = obj.simulatedWatts;
        document.getElementById("simulatedCad").value = obj.simulatedCad;
        document.getElementById("connectedPowerMeter").value = obj.connectedPowerMeter;
        document.getelementByID("debug").innerHTML = obj.debug;
      }
    };
    xhttp.open("GET", "/configJSON", true);
    xhttp.send();
  }

//define function to load css
var loadCss = function(){
    var cssLink = document.createElement('link');
    cssLink.rel = 'stylesheet';
    cssLink.href = 'style.css';
    var head = document.getElementsByTagName('head')[0];
    head.parentNode.insertBefore(cssLink, head);
};
 
//Delay loading css to not swamp webserver
window.addEventListener('load', function (){
  setTimeout(loadCss, 100);
}, false);

</script>

</html>
